---
title: linux sudo 提权漏洞(CVE-2019-14287)复现
date: 2019-10-15 13:15:23
author: dylan
top: false
cover: false
password: 
categories: web安全
tags: 
    - Linux
    - 提权
    - 漏洞复现
    - sudo
---

# 0x00 漏洞概述

2019年10月14日， sudo 官方在发布了CVE-2019-14287的漏洞预警。

sudo 是所有 unix操作系统(BSD, MacOS, GNU/Linux) 基本集成的一个用户权限控制/切换程序。
允许管理员控制服务器下用户能够切换的用户权限。
CVE-2019-14287是管理员在配置文件中用了ALL关键词后造成的。
但默认的sudo配置文件不受影响。

# 0x01 影响版本

**1.8.28之前的Sudo版本会受到影响。**

# 0x02 漏洞详情

当 /etc/sudoers 文件存在如下形式的配置会导致漏洞的产生

`username  ALL=(ALL, !root) ALL`

即使限制了用户以root用户身份运行特定命令或任何命令，
该漏洞也可能允许用户绕过此安全策略并完全控制系统。

攻击者可以利用此漏洞，只需指定用户ID“ -1”或“ 4294967295”即可以root身份运行命令而不受限制。

这是因为将用户ID转换为用户名的函数将-1或其无符号等效4294967295误认为是0，
该值始终是root用户的用户ID。
此外，由于通过–u 选项指定的用户 ID 并不存在于密码数据库中，
因此不会运行任何 PAM 会话模块。

` sudo -u＃-1 id -u`
或者
`sudo -u＃4294967295 id -u`

# 0x03 漏洞复现

![](https://raw.githubusercontent.com/dylan903/ImgUrl/master/Img/20191015161111.png)

# 参考文章
[https://www.sudo.ws/alerts/minus_1_uid.html](https://www.sudo.ws/alerts/minus_1_uid.html)
[https://news.ssssafe.com/archives/3266](https://news.ssssafe.com/archives/3266)
